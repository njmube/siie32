/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * SPanelRecord.java
 *
 * Created on 11/03/2010, 01:31:10 PM
 */

package erp.mfin.form;

import erp.data.SDataConstants;
import erp.data.SDataReadDescriptions;
import erp.data.SDataUtilities;
import erp.lib.SLibConstants;
import erp.mfin.data.SDataRecord;

/**
 *
 * @author Sergio Flores
 */
public class SPanelRecord extends javax.swing.JPanel {

    private erp.client.SClientInterface miClient;
    private java.lang.Object moPrimaryKey;

    /** Creates new form SPanelRecord */
    public SPanelRecord(erp.client.SClientInterface client) {
        miClient = client;
        moPrimaryKey = null;
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jlRecord = new javax.swing.JLabel();
        jtfDate = new javax.swing.JTextField();
        jtfBranch = new javax.swing.JTextField();
        jtfNumber = new javax.swing.JTextField();
        jbView = new javax.swing.JButton();

        setLayout(new java.awt.BorderLayout());

        jPanel1.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT, 2, 0));

        jlRecord.setText("Póliza contable:");
        jlRecord.setPreferredSize(new java.awt.Dimension(85, 23));
        jPanel1.add(jlRecord);

        jtfDate.setEditable(false);
        jtfDate.setText("01/01/2000");
        jtfDate.setToolTipText("Fecha de la póliza contable");
        jtfDate.setFocusable(false);
        jtfDate.setPreferredSize(new java.awt.Dimension(65, 23));
        jPanel1.add(jtfDate);

        jtfBranch.setEditable(false);
        jtfBranch.setText("SUC");
        jtfBranch.setToolTipText("Sucursal de la empresa");
        jtfBranch.setFocusable(false);
        jtfBranch.setPreferredSize(new java.awt.Dimension(35, 23));
        jPanel1.add(jtfBranch);

        jtfNumber.setEditable(false);
        jtfNumber.setText("TP-000001");
        jtfNumber.setToolTipText("Número de póliza contable");
        jtfNumber.setFocusable(false);
        jtfNumber.setPreferredSize(new java.awt.Dimension(65, 23));
        jPanel1.add(jtfNumber);

        jbView.setIcon(new javax.swing.ImageIcon(getClass().getResource("/erp/img/icon_std_look.gif"))); // NOI18N
        jbView.setToolTipText("Ver póliza contable");
        jbView.setPreferredSize(new java.awt.Dimension(23, 23));
        jbView.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbViewActionPerformed(evt);
            }
        });
        jPanel1.add(jbView);

        add(jPanel1, java.awt.BorderLayout.PAGE_START);
    }// </editor-fold>//GEN-END:initComponents

    private void jbViewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbViewActionPerformed
        miClient.getGuiModule(SDataConstants.MOD_FIN).showForm(SDataConstants.FINX_REC_RO, moPrimaryKey);
    }//GEN-LAST:event_jbViewActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel jPanel1;
    private javax.swing.JButton jbView;
    private javax.swing.JLabel jlRecord;
    private javax.swing.JTextField jtfBranch;
    private javax.swing.JTextField jtfDate;
    private javax.swing.JTextField jtfNumber;
    // End of variables declaration//GEN-END:variables

    public void setRecordKey(java.lang.Object pk) {
        SDataRecord record = null;

        moPrimaryKey = pk;

        if (moPrimaryKey != null) {
             record = (SDataRecord) SDataUtilities.readRegistry(miClient, SDataConstants.FIN_REC, moPrimaryKey, SLibConstants.EXEC_MODE_VERBOSE);
        }

        if (moPrimaryKey == null || record == null) {
            jtfDate.setText("");
            jtfBranch.setText("");
            jtfNumber.setText("");
            jbView.setEnabled(false);
        }
        else {
            jtfDate.setText(miClient.getSessionXXX().getFormatters().getDateFormat().format(record.getDate()));
            jtfBranch.setText(SDataReadDescriptions.getCatalogueDescription(miClient, SDataConstants.BPSU_BPB, new int[] { record.getFkCompanyBranchId() }, SLibConstants.DESCRIPTION_CODE));
            jtfNumber.setText(record.getPkRecordTypeId() + "-" + record.getPkNumberId());
            jbView.setEnabled(true);
        }
    }
}
